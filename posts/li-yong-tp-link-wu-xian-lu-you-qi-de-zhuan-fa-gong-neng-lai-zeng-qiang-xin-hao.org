# -*- mode: Org; org-download-image-dir: "../images"; -*-
#+TITLE: 利用 TP-LINK 无线路由器的转发功能来增强信号
#+DATE: 2017-02-04 12:34:58 
#+TAGS: 
#+CATEGORY: 
#+LINK: 
#+DESCRIPTION: 
#+LAYOUT : post

以TP-LINK 300M 无线路由器(TL_WR842N)为例，假设已经连接网络的路由器为A，用于桥接的路由器为B。

* 如果遗忘了无线路由器的密码

** 先恢复出厂设置
  
    用大头钉顶住 Reset 的小孔，直到状态灯闪烁。状态灯会连续闪烁5下。
** 进入管理页面

1. 连接无线路由器的网络，SSID 为 =TP-LINK_****= ，此时无密码，可直接连接

2. 打开浏览器，在地址栏中输入 192.168.1.1 ，回车

3. 初次进入，会要求你设置密码
   #+DOWNLOADED: /tmp/screenshot.png @ 2017-02-04 12:54:41
   [[file:../images/如果遗忘了无线路由器 B 的密码/screenshot_2017-02-04_12-54-41.png]]

4. 输入密码后，进入这个页面
   #+DOWNLOADED: /tmp/screenshot.png @ 2017-02-04 13:00:05  
   [[file:../images/如果遗忘了无线路由器的密码/screenshot_2017-02-04_13-00-05.png]]

** 更改路由器管理页面的 IP
这里的更改是为了与路由器 A 的地址相区别，不然转发网络之后就找不到路由器B 的管理页面了

在网页左侧选择“网络参数”──“LAN口设置”，修改为与路由器 A 不同的地址。因为我们这里路由器 A 没有修改过，默认值为 192.168.1.1, 我们把路由器 B 设置成 192.168.1.2

  #+DOWNLOADED: /tmp/screenshot.png @ 2017-02-04 13:06:52
  [[file:../images/如果遗忘了无线路由器的密码/screenshot_2017-02-04_13-06-52.png]] 
   
7. 保存后会自动重启 



* 设置无线路由器 B 转发网络信号 

** 进入管理页面

我们这里是刚才设置的 192.168.1.2

#+DOWNLOADED: /tmp/screenshot.png @ 2017-02-04 13:11:22
[[file:../images/设置 WDS/screenshot_2017-02-04_13-11-22.png]]
** 设置WDS

在网页左侧选择“无线设置”──“基本设置”

#+DOWNLOADED: /tmp/screenshot.png @ 2017-02-04 13:16:34
[[file:../images/设置无线路由器 B 转发网络信号/screenshot_2017-02-04_13-16-34.png]]

点击 “开启WDS”


#+DOWNLOADED: /tmp/screenshot.png @ 2017-02-04 13:20:50
[[file:../images/设置无线路由器 B 转发网络信号/screenshot_2017-02-04_13-20-50.png]]

点击“(桥接的)BSSID” 下面的 “扫描” 按钮，

#+DOWNLOADED: /tmp/screenshot.png @ 2017-02-04 13:23:39
[[file:../images/设置无线路由器 B 转发网络信号/screenshot_2017-02-04_13-23-39.png]]

从列表中选择路由器A对应的网络，点击后面的 “连接” 按钮，回到前面的页面并输入密码

#+DOWNLOADED: /tmp/screenshot.png @ 2017-02-04 13:27:44
[[file:../images/设置无线路由器 B 转发网络信号/screenshot_2017-02-04_13-27-44.png]]


点击保存，提示 =您已经更改了无线设置，重启后生效=
#+DOWNLOADED: /tmp/screenshot.png @ 2017-02-04 13:31:05
[[file:../images/设置无线路由器 B 转发网络信号/screenshot_2017-02-04_13-31-05.png]]

点击 “重启”，进入下面的页面，再点击“重启路由器”

#+DOWNLOADED: /tmp/screenshot.png @ 2017-02-04 13:31:43
[[file:../images/设置无线路由器 B 转发网络信号/screenshot_2017-02-04_13-31-43.png]]

重新连接无线网，进入管理页面 192.168.1.2,在默认的“运行状态”页面，等待“无线状态”中的“WDS状态”显示“成功”，


#+DOWNLOADED: /tmp/screenshot.png @ 2017-02-04 13:48:25
[[file:../images/设置无线路由器 B 转发网络信号/screenshot_2017-02-04_13-48-25.png]]

在网页左侧选择“DHCP服务器”──“DHCP服务”，设置成不启用

#+DOWNLOADED: /tmp/screenshot.png @ 2017-02-04 14:20:13
[[file:../images/设置无线路由器 B 转发网络信号/screenshot_2017-02-04_14-20-13.png]]

此时应该可以在地址栏输入 192.168.1.1,看到路由器A的管理界面了


* 设置无线路由器 B 的名称和密码 

1. 名称：在网页左侧选择“无线设置”──“基本设置”，SSID号即为网络名称
2. 密码：在“无线设置”──“无线安全设置”，选择 WPA-PSK/WPA2-PSK，PSK 密码中写入密码

* 备注：路由器桥接(WDS) 无法从副路由（B路由,从路由）上网 解决方法(DHCP设置)


许多同学都已经在家中搭建无线网络,但由于墙体等障碍物的阻挡,让无线信号衰减得十分厉害,为了解决这个问题相信不少同学已经开始尝试在家中使用无线桥接路由器的方法来拓展无线网络的范围

但是很多同学反映,路由器桥接是成功了,但还是只能从主路由（A路由）上网,却无法从副路由（B路由,从路由）上网,找遍了各种教程,依然无法解决,

甚至有的同学弄了好几天也没弄好,又是气,又是无奈

本教程将帮您解决路由器桥接,无法从副路由上网的问题

目前绝大多数同学桥接是用的是WDS----无线分布式系统来桥接两台路由器,本教程主要针对WDS功能,Brigde功能本教程不一定能解决

据了解,大部分同学桥接路由器的方法要么是从百度文库等地方查阅,要么就是参考路由器说明书,依本人看来,这些方法都是不靠铺的,都是不完整的,这些教程仅简单阐述了如何桥接两台路由器,却没有解决实际的上网问题

很多教程都有这一步:在设置副路由（B路由,从路由）的时候都关闭了DHCP服务器-----动态主机设置协议（能自动给设备分配IP地址）,导致所有连接到副路由的设备都无法得到IP地址[有部分同学开启了,但没有进行设置,所以即使设备得道的IP地址也是无效的]

解决方法有以下两个:

** 手动为设备设置IP地址（繁琐,不推荐）

 1. 从主路由获取以下信息:
    1. 主路由的LAN口IP地址
    2. 主路由的子网掩码（又叫网络掩码，地址掩码,子网络遮罩）
    3. 主路由的WAN口得到的DNS服务器地址，一共有2个
 2. 给自己的各个无线和有线设备设置IP地址
    1. 如何为Android手机设置IP地址: http://www.tp-link.com.cn/pages/article-detail.asp?result=school&d=208
    2. 如何为IPAD/IPHONE设置IP地址: http://www.tp-link.com.cn/pages/article-detail.asp?result=school&d=197
    3. 如何设置苹果笔记本IP地址: http://www.tp-link.com.cn/pages/article-detail.asp?result=school&d=196
    4. Windows的就不说了自己上网查一下


** 手动配置副路由的DHCP服务器(较为简单,强烈推荐)
 1. 从主路由获取以下信息:
    1. 主路由的LAN口IP地址
    2. 主路由的子网掩码(又叫网络掩码，地址掩码,子网络遮罩)
    3. 主路由的WAN口得到的DNS服务器地址，一共有2个
    4. 主路由的DHCP服务器地址池（起始地址到结束地址叫做一个地址池）
 2. 开启副路由的DHCP服务器
    1. 将副路由DHCP的地址池设置成与主路由的没有交集的状态
    2. 例如主路由是192.168.1.100到192.168.1.199
    3. 那么副路由可以是192.168.1.50-192.168.1.99或者192.168.1.200-192.168.1.225
    4. 地址池租期不用更改
    5. 在副路由DHCP的网关处填写主路由的LAN口IP地址，一般都是192.168.1.1
    6. 缺省域名一栏空着
    7. 在副路由DHCP的主DNS服务器和备用DNS服务器处填写从主路由WAN口得到的DNS服务器地址

 保存并重器副路由，再连接到副路由看看是不是能够上网了

** 原理解说：
一台设备能够上网首先必须获得一个有效的IP地址（由IP地址，子网掩码和DNS服务器组成）

一般主路由DHCP服务器是默认开启的，所以连接到主路由的设备都能够通过主路由DHCP服务器指派得到有效的IP地址从而能上网

而若关闭了副路由的DHCP服务器，那么连接到副路由的设备将无法通过副路由DHCP服务器指派得到IP地址而不能上网

即便开启了，由于副路由默认的DHCP服务器指派的IP地址仅适用于通过副路由WAN口上网的，所以此IP地址无法通过主路由WAN口上网，即是无效IP地址

因此我们需要修改副路由的DHCP服务器设置，使得其分配的IP地址能通过主路由WAN口来上网

那么首先IP地址要与主路由在同一网段（一般只要保证IP地址最后3位不和主或副路由相同即可）

由于主路由相当于一台服务器，那么网关就是其本身的LAN口IP地址，所以副路由DHCP的网关应该满足与主路由的LAN口IP地址一样
接下来是DNS服务器，主路由能够上网还有一个条件就是有效的DNS服务器地址，一般通过WAN口拨号或者动态IP都能够得到2个DNS服务器地址，一个是主DNS服务器，另一个是备用DNS服务器
那么我们还需给副路由的DHCP服务器设置DNS服务器地址，这样一来，通过副路由DHCP服务器指派得到的IP地址就能够通过主路由的WAN口上网，也就是说，通过副路由DHCP服务器指派得到的IP地址是有效的
这样便解决无法从副路由上网的问题了
本教程到此也就结束了，希望各有所收获，也不忘相互传阅，来帮助更多的人，有疑问的可以与本人交流

